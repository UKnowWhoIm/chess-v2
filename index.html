<!DOCTYPE html>
<html>
  <head>
    <script
			  src="https://code.jquery.com/jquery-3.5.1.min.js"
			  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
        crossorigin="anonymous"></script>
    <script src="/static/chessCommonJS.js"></script>
    <script src="/static/chessClient.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <style>
      table{
          margin: auto;
      }
      .highlight{
        background-color: coral!important;
      }
      td{
          height: 60px;
          width: 60px;
          text-align: center;
          font-size: 48px;
          cursor: pointer;
      }
      .light-cell{
          background-color: lightblue;
      }
      .dark-cell{
          background-color: grey;
      }
      .selected{
          background-color:orange;
      }
    </style>
    <title></title>
  </head>
  <body>
    <div id="board">

    </div>
    <script>
        let socket = io();
        socket.on("getGameId", function(gameId){
            sessionStorage.setItem("gameId", gameId);
            console.log(gameId);
        });

        socket.on("startGame", (fen) => {
            console.log(fen);
            board = new Board(fen);
            postMove();
        });

        socket.on("boardUpdated", (fen) => {
            console.log(fen);
            board = new Board(fen);
            postMove();
            if(board.player == sessionStorage.getItem("player"))
                alert("Your Turn");
        });

        socket.on("playerColor", (player) => {
            sessionStorage.setItem("player", player);
            if(player == Players.white)
                alert("You\'re playing as white");
            else
                alert("You\'re playing as black");
        });

        socket.on("playerJoined", () => alert("A Player has joined"));

        socket.on("invalidMove", () => alert("That move isn\'t allowed"));

        socket.on("invalidRoomId", (silent) => {
            if(!silent)
                alert("Invalid Room Id");
        });
        
        $("#board").delegate("td", "click", function(){
            processClick(socket, this.id);
        });
       
        function createRoom(){
            socket.emit("roomCreate");
        }

        function joinRoom(id){
            socket.emit("roomJoin", id);
        }

        $(document).ready(function(){
            let roomId = sessionStorage.getItem("gameId");
            if(roomId)
                socket.emit("roomJoin", roomId, true);
        })
      </script>
  </body>
</html>